# é˜¶æ®µ 10ï¼šéƒ¨ç½²ä¸è¿ç»´ ğŸ“‹

> æœ¬é˜¶æ®µå°†å…¨éƒ¨æœåŠ¡å®¹å™¨åŒ–ï¼Œç¼–å†™ Docker Compose éƒ¨ç½²æ–¹æ¡ˆï¼Œå¹¶é…ç½®ç›‘æ§ã€‚

## 10.1 Docker å®¹å™¨åŒ–

### å„æœåŠ¡ Dockerfile

```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM golang:1.25-alpine AS builder
WORKDIR /app
COPY go.mod go.sum ./
RUN go mod download
COPY . .
RUN CGO_ENABLED=0 go build -o /server ./services/<name>/api/<name>.go

FROM alpine:latest
COPY --from=builder /server /server
COPY ./services/<name>/api/etc/<name>-api.yaml /etc/<name>-api.yaml
ENTRYPOINT ["/server", "-f", "/etc/<name>-api.yaml"]
```

### Docker Compose

```yaml
services:
  postgres:
    image: postgres:16
    environment:
      POSTGRES_PASSWORD: 123456
    ports:
      - "5432:5432"

  redis:
    image: redis:7
    ports:
      - "6379:6379"

  user-api:
    build:
      context: .
      dockerfile: deploy/docker/user-api.Dockerfile
    ports:
      - "8801:8801"
    depends_on:
      - postgres
      - redis

  # ... å…¶ä»– 18 ä¸ªæœåŠ¡
```

---

## 10.2 æ•°æ®åº“åˆå§‹åŒ–

```bash
# æ‰§è¡Œå…¨éƒ¨å»ºè¡¨è„šæœ¬
psql -U postgres -f deploy/sql/db_user.sql
psql -U postgres -f deploy/sql/db_product.sql
psql -U postgres -f deploy/sql/db_inventory.sql
psql -U postgres -f deploy/sql/db_cart.sql
psql -U postgres -f deploy/sql/db_promotion.sql
psql -U postgres -f deploy/sql/db_order.sql
psql -U postgres -f deploy/sql/db_payment.sql
psql -U postgres -f deploy/sql/db_logistics.sql
```

---

## 10.3 ç›‘æ§ä¸æ—¥å¿—

- **Prometheus**: æ¥å…¥ go-zero å†…ç½® metrics
- **Grafana**: å¯è§†åŒ–ä»ªè¡¨ç›˜
- **ELK**: æ—¥å¿—æ”¶é›†ä¸åˆ†æ

---

## 10.4 æœåŠ¡å¯åŠ¨é¡ºåº

```
1. PostgreSQL + Redis
2. RPC æœåŠ¡ï¼ˆUser/Product/Inventory/Cart/Promotion/Order/Payment/Logisticsï¼‰
3. API æœåŠ¡ï¼ˆUser/Auth/Product/Search/Cart/Promotion/Order/Payment/Seckill/Logisticsï¼‰
```

---

> è¯·å›å¤ **"ç»§ç»­é˜¶æ®µ 10"** å¼€å§‹éƒ¨ç½²ä¸è¿ç»´ã€‚
