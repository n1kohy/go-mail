# Example: Generate Service with Dynamic Context

This example shows how to create a go-zero service generation skill that uses live project information.

## Skill Configuration

```yaml
---
name: generate-api-service
description: Generate a go-zero REST API service with proper structure
argument-hint: [service-name] [port]
disable-model-invocation: true
allowed-tools:
  - Bash(goctl *)
  - Write
  - Read
---

Generate go-zero API service: $0 on port $1

## Project Context
- Existing services: !`find . -maxdepth 2 -name "*.api" -type f | xargs -I {} basename {} .api`
- Current directory: !`pwd`
- Go version: !`go version`

## Generation Steps

1. **Create API Definition**
   Create `$0.api` with basic structure:
   ```go
   syntax = "v1"

   info(
       title: "$0 API"
       desc: "$0 service API"
       author: "Generated by Claude Code"
       version: "1.0"
   )

   type (
       HelloReq {
           Name string `json:"name"`
       }
       HelloResp {
           Message string `json:"message"`
       }
   )

   service $0-api {
       @handler Hello
       post /hello (HelloReq) returns (HelloResp)
   }
   ```

2. **Generate Code**
   Run: `goctl api go -api $0.api -dir .`

3. **Update Config**
   Modify `etc/$0-api.yaml` to use port $1

4. **Verify Structure**
   Check that these directories exist:
   - internal/handler/
   - internal/logic/
   - internal/svc/
   - internal/types/

5. **Next Steps**
   - Implement business logic in internal/logic/
   - Add middleware if needed
   - Test with: `go run $0.go -f etc/$0-api.yaml`
```

## Key Features

### Dynamic Context Injection
```bash
!`find . -maxdepth 2 -name "*.api" -type f | xargs -I {} basename {} .api`
```
This shows existing services to avoid naming conflicts.

### Argument Substitution
- `$0` or `$ARGUMENTS[0]` → First argument (service name)
- `$1` or `$ARGUMENTS[1]` → Second argument (port)
- `$ARGUMENTS` → All arguments combined

### Invocation Examples
```
/generate-api-service user 8080
/generate-api-service order 8081
```

## Manual Invocation Only

`disable-model-invocation: true` prevents Claude from running this automatically. You must invoke with `/generate-api-service` to ensure:
- You control when services are created
- Prevents accidental code generation
- Clear user intent for side effects

## Combined with mcp-zero

If you have [mcp-zero](https://github.com/zeromicro/mcp-zero) installed, Claude can:
1. Use this skill for planning and structure
2. Execute actual `goctl` commands via mcp-zero tools
3. Validate generated code automatically

See [getting-started/claude-code-guide.md](../getting-started/claude-code-guide.md) for integration details.
